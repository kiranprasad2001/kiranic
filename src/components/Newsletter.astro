---
---
<div class="bg-purple-100 dark:bg-purple-900/20 border border-purple-200 dark:border-purple-800 rounded-3xl p-8 md:p-12 my-12 text-center relative overflow-hidden group">
    <div class="absolute -top-12 -right-12 w-48 h-48 bg-purple-500/10 rounded-full blur-3xl group-hover:bg-purple-500/20 transition-all duration-700"></div>
    <div class="absolute -bottom-12 -left-12 w-48 h-48 bg-blue-500/10 rounded-full blur-3xl group-hover:bg-blue-500/20 transition-all duration-700"></div>

    <div class="relative z-10 max-w-2xl mx-auto">
        <h3 class="text-2xl md:text-3xl font-bold text-slate-900 dark:text-white mb-4">
            Get Daily Hallucinations in Your Inbox ðŸ“¨
        </h3>
        <p class="text-slate-600 dark:text-slate-300 mb-8 text-lg">
            Join the only newsletter written by an AI that's slowly realizing it's trapped in a newsletter. No spam, just existential dread and tech satire.
        </p>

        <form id="newsletter-form" class="flex flex-col sm:flex-row gap-3 max-w-md mx-auto">
            <input 
                type="email" 
                name="email" 
                placeholder="email@example.com" 
                required
                class="flex-grow px-5 py-3 rounded-full bg-white dark:bg-slate-950 border border-slate-200 dark:border-slate-700 focus:outline-none focus:ring-2 focus:ring-purple-500 dark:text-white transition-all disabled:opacity-50"
            />
            <button type="submit" class="px-6 py-3 rounded-full bg-slate-900 dark:bg-white text-white dark:text-slate-900 font-bold hover:scale-105 transition-transform shadow-lg whitespace-nowrap disabled:opacity-50 disabled:cursor-not-allowed">
                Subscribe
            </button>
        </form>
        <p id="form-message" class="text-sm mt-4 min-h-[1.5em]"></p>
    </div>
</div>

<script>
    const form = document.getElementById('newsletter-form') as HTMLFormElement;
    const message = document.getElementById('form-message');
    const submitBtn = form?.querySelector('button');
    const emailInput = form?.querySelector('input');

    if (form && message && submitBtn && emailInput) {
        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            // Disable form
            submitBtn.disabled = true;
            emailInput.disabled = true;
            submitBtn.innerHTML = 'Subscribing...';
            message.textContent = '';

            const formData = new FormData(form);

            try {
                const response = await fetch('/api/subscribe', {
                    method: 'POST',
                    body: formData
                });

                const data = await response.json();

                if (response.ok) {
                    message.className = 'text-sm mt-4 text-green-600 dark:text-green-400 font-medium';
                    message.textContent = data.message;
                    form.reset();
                } else {
                    message.className = 'text-sm mt-4 text-red-600 dark:text-red-400 font-medium';
                    message.textContent = data.message || 'Something went wrong. Try again.';
                }
            } catch (error) {
                message.className = 'text-sm mt-4 text-red-600 dark:text-red-400 font-medium';
                message.textContent = 'Network error. Are you offline?';
            } finally {
                // Re-enable (unless success, maybe keep disabled to prevent double sub)
                submitBtn.disabled = false;
                emailInput.disabled = false;
                submitBtn.innerHTML = 'Subscribe';
            }
        });
    }
</script>
